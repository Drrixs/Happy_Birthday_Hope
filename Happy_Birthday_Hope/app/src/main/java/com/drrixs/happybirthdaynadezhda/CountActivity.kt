//   [RU]
//   â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
//   ğŸŒŸ ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ¾ Ğ´Ğ»Ñ: t.me/@Albesus
//   ğŸ› ï¸ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ĞµĞ»ÑŒ ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ: t.me/@Drrixs
//   â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
//   âš ï¸ Ğ’Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ: ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ñ‹ Ğ¼Ğ¾Ğ³ÑƒÑ‚ ÑÑ‚Ğ°Ñ‚ÑŒ Ğ½ĞµĞ°ĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ğ¸Ğ»Ğ¸ Ğ½ĞµĞ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ ÑĞ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½ĞµĞ¼.
//   ğŸ“¬ Ğ”Ğ»Ñ Ğ´Ğ¾Ğ»Ğ³Ğ¾ÑÑ€Ğ¾Ñ‡Ğ½Ğ¾Ğ¹ ÑĞ²ÑĞ·Ğ¸, Ğ²Ğ¾Ñ‚ Ğ¼Ğ¾Ğ¸ Ğ¿Ğ¾Ñ‡Ñ‚Ğ¾Ğ²Ñ‹Ğµ Ğ°Ğ´Ñ€ĞµÑĞ°:
//      ĞŸĞ¾Ñ‡Ñ‚Ğ° 1 - [Ğ°Ğ´Ñ€ĞµÑ]
//      ĞŸĞ¾Ñ‡Ñ‚Ğ° 2 - [Ğ°Ğ´Ñ€ĞµÑ]
//      ĞŸĞ¾Ñ‡Ñ‚Ğ° 3 - [Ğ°Ğ´Ñ€ĞµÑ]
//   ğŸ‘‰ Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ½Ğ° Ğ²ÑĞµ ÑÑ€Ğ°Ğ·Ñƒ Ğ´Ğ»Ñ ÑƒĞ²ĞµÑ€ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ² Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞµ.
//   â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
//   [EN]
//   â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
//   ğŸŒŸ App Developed for: t.me/@Albesus
//   ğŸ› ï¸ App Creator: t.me/@Drrixs
//   â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
//   âš ï¸ Attention: Contacts may become outdated or invalid over time.
//   ğŸ“¬ For long-term communication, here are my email addresses:
//      Email 1 - [address]
//      Email 2 - [address]
//      Email 3 - [address]
//   ğŸ‘‰ It's recommended to write to all simultaneously to ensure delivery.
//   â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”






package com.drrixs.happybirthdaynadezhda

import android.animation.Animator
import android.animation.AnimatorListenerAdapter
import android.media.MediaPlayer
import android.os.Bundle
import android.view.View
import android.widget.Toast
import androidx.appcompat.app.AppCompatActivity
import com.drrixs.happybirthdaynadezhda.databinding.CountBinding

class CountActivity : AppCompatActivity() {



    private lateinit var mediaPlayer: MediaPlayer
    private lateinit var binding: CountBinding
    private val prefs by lazy { getSharedPreferences("APP_PREFERENCES", MODE_PRIVATE) }

    override fun onResume() {
        super.onResume()
        val currentTime = System.currentTimeMillis()
        val endTime = prefs.getLong("END_TIME", 0)

        if (currentTime < endTime) {
            finish()
        }
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = CountBinding.inflate(layoutInflater)
        setContentView(binding.root)

        mediaPlayer = MediaPlayer.create(this, R.raw.alan_walker)

        mediaPlayer.start()
        setupAnim()
        parade()
    }

    private fun setupAnim() {
        binding.animationView.apply {
            setAnimation("animloveyou.json")
            repeatCount = 0
            addAnimatorListener(object : Animator.AnimatorListener {
                override fun onAnimationStart(animation: Animator) {

                }

                override fun onAnimationEnd(animation: Animator) {

                    binding.animationView.visibility = View.GONE
                    showAndFadeOutImageView()
                }

                override fun onAnimationCancel(animation: Animator) {

                }

                override fun onAnimationRepeat(animation: Animator) {

                }
            })
            playAnimation()
        }
    }

    private fun showAndFadeOutImageView() {
        binding.imageView2.apply {
            visibility = View.VISIBLE
            alpha = 0f


            animate()
                .alpha(1f)
                .setDuration(2000)
                .setListener(object : AnimatorListenerAdapter() {
                    override fun onAnimationEnd(animation: Animator) {

                        animate()
                            .setStartDelay(30000)
                            .alpha(0f)
                            .setDuration(2000)
                            .setListener(object : AnimatorListenerAdapter() {
                                override fun onAnimationEnd(animation: Animator) {
                                    visibility = View.GONE
                                    byebye()
                                }
                            })
                    }
                })
        }
    }

    private fun byebye() {
        binding.imageViewByeBye.apply {
            visibility = View.VISIBLE
            alpha = 0f

            animate()
                .alpha(1f)
                .setDuration(1000)
                .setListener(object : AnimatorListenerAdapter() {
                    override fun onAnimationEnd(animation: Animator) {
                        animate()
                            .setStartDelay(500)
                            .alpha(0f)
                            .setDuration(1000)
                            .setListener(object : AnimatorListenerAdapter() {
                                override fun onAnimationEnd(animation: Animator) {
                                    visibility = View.GONE
                                    finish()
                                }
                            })
                    }
                })
        }
    }
    
    private fun parade() {
        binding.konfettiView.start(Presets.parade())
    }
}
